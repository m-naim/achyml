version: 1
components:
  # --- User & Auth Domain ---
  - id: svc-auth
    type: microservice
    name: auth-service
    level: 3
    column: 1
    elements:
      - id: route-login
        type: route
        method: POST
        path: /login
        dependencies:
          - to: user-get
      - id: route-register
        type: route
        method: POST
        path: /register
        dependencies:
          - to: user-get
      - id: route-profile
        type: route
        method: GET
        path: /profile
        dependencies:
          - to: user-get
      - id: route-logout
        type: route
        method: POST
        path: /logout
        dependencies: []
      - id: route-forgot
        type: route
        method: POST
        path: /forgot
        dependencies: []
      - id: route-reset
        type: route
        method: POST
        path: /reset
        dependencies: []
      - id: route-verify
        type: route
        method: GET
        path: /verify
        dependencies: []
      - id: route-refresh
        type: route
        method: POST
        path: /refresh
        dependencies: []
      - id: route-mfa
        type: route
        method: POST
        path: /mfa
        dependencies: []
      - id: route-mfa-verify
        type: route
        method: POST
        path: /mfa/verify
        dependencies: []
      # Add more routes for SSO, OAuth, device management, etc.
      - id: route-sso
        type: route
        method: POST
        path: /sso
        dependencies: []
      - id: route-oauth
        type: route
        method: POST
        path: /oauth
        dependencies: []
      - id: route-device-register
        type: route
        method: POST
        path: /device/register
        dependencies: []
      - id: route-device-verify
        type: route
        method: GET
        path: /device/verify
        dependencies: []
  - id: svc-user
    type: microservice
    name: user-service
    level: 3
    column: 2
    elements:
      - id: user-get
        type: route
        method: GET
        path: /user
        dependencies:
          - to: users-coll
      - id: user-update
        type: route
        method: PUT
        path: /user/update
        dependencies:
          - to: users-coll
      - id: user-delete
        type: route
        method: DELETE
        path: /user/delete
        dependencies:
          - to: users-coll
      - id: user-list
        type: route
        method: GET
        path: /users
        dependencies:
          - to: users-coll
      - id: user-create
        type: route
        method: POST
        path: /user/create
        dependencies:
          - to: users-coll
      - id: user-activate
        type: route
        method: POST
        path: /user/activate
        dependencies:
          - to: users-coll
      - id: user-deactivate
        type: route
        method: POST
        path: /user/deactivate
        dependencies:
          - to: users-coll
      - id: user-role
        type: route
        method: GET
        path: /user/role
        dependencies:
          - to: users-coll
      - id: user-permissions
        type: route
        method: GET
        path: /user/permissions
        dependencies:
          - to: users-coll
      - id: user-settings
        type: route
        method: GET
        path: /user/settings
        dependencies:
          - to: users-coll
      # Add more routes for address, preferences, wishlist, etc.
      - id: user-address
        type: route
        method: GET
        path: /user/address
        dependencies:
          - to: users-coll
      - id: user-preferences
        type: route
        method: GET
        path: /user/preferences
        dependencies:
          - to: users-coll
      - id: user-wishlist
        type: route
        method: GET
        path: /user/wishlist
        dependencies:
          - to: users-coll
      - id: user-orders
        type: route
        method: GET
        path: /user/orders
        dependencies:
          - to: orders-table
  # --- Product Domain ---
  - id: svc-product
    type: microservice
    name: product-service
    level: 2
    column: 3
    elements:
      - id: product-list
        type: route
        method: GET
        path: /products
        dependencies:
          - to: products-table
      - id: product-detail
        type: route
        method: GET
        path: /products/:id
        dependencies:
          - to: products-table
      - id: product-update
        type: route
        method: PUT
        path: /products/:id
        dependencies:
          - to: products-table
      - id: product-create
        type: route
        method: POST
        path: /products
        dependencies:
          - to: products-table
      - id: product-delete
        type: route
        method: DELETE
        path: /products/:id
        dependencies:
          - to: products-table
      - id: product-search
        type: route
        method: GET
        path: /products/search
        dependencies:
          - to: products-table
      - id: product-featured
        type: route
        method: GET
        path: /products/featured
        dependencies:
          - to: products-table
      - id: product-category
        type: route
        method: GET
        path: /products/category/:cat
        dependencies:
          - to: products-table
      - id: product-stock
        type: route
        method: GET
        path: /products/:id/stock
        dependencies:
          - to: products-table
      - id: product-reviews
        type: route
        method: GET
        path: /products/:id/reviews
        dependencies:
          - to: products-table
      # Add more routes for bulk import, export, analytics, etc.
      - id: product-import
        type: route
        method: POST
        path: /products/import
        dependencies:
          - to: products-table
      - id: product-export
        type: route
        method: GET
        path: /products/export
        dependencies:
          - to: products-table
      - id: product-analytics
        type: route
        method: GET
        path: /products/analytics
        dependencies:
          - to: products-table
      - id: product-tags
        type: route
        method: GET
        path: /products/tags
        dependencies:
          - to: products-table
  # --- Order Domain ---
  - id: svc-order
    type: microservice
    name: order-service
    level: 2
    column: 1
    elements:
      - id: order-create
        type: route
        method: POST
        path: /orders
        dependencies:
          - to: orders-table
          - to: payment-init
      - id: order-status
        type: route
        method: GET
        path: /orders/:id/status
        dependencies:
          - to: orders-table
      - id: order-cancel
        type: route
        method: DELETE
        path: /orders/:id
        dependencies:
          - to: orders-table
      # Add more routes for returns, refunds, tracking, etc.
      - id: order-return
        type: route
        method: POST
        path: /orders/:id/return
        dependencies:
          - to: orders-table
      - id: order-refund
        type: route
        method: POST
        path: /orders/:id/refund
        dependencies:
          - to: orders-table
      - id: order-track
        type: route
        method: GET
        path: /orders/:id/track
        dependencies:
          - to: orders-table
      - id: order-history
        type: route
        method: GET
        path: /orders/history
        dependencies:
          - to: orders-table
      - id: order-analytics
        type: route
        method: GET
        path: /orders/analytics
        dependencies:
          - to: orders-table
  # --- Payment Domain ---
  - id: svc-payment
    type: microservice
    name: payment-service
    level: 2
    column: 2
    elements:
      - id: payment-init
        type: route
        method: POST
        path: /payments
        dependencies:
          - to: payments-table
          - to: billing-table   # <-- changed from 'billing-create' to 'billing-table'
      - id: payment-status
        type: route
        method: GET
        path: /payments/:id
        dependencies:
          - to: payments-table
      # Add more routes for payment methods, invoices, fraud, etc.
      - id: payment-methods
        type: route
        method: GET
        path: /payments/methods
        dependencies:
          - to: payments-table
      - id: payment-invoice
        type: route
        method: GET
        path: /payments/:id/invoice
        dependencies:
          - to: payments-table
      - id: payment-fraud
        type: route
        method: POST
        path: /payments/fraud
        dependencies:
          - to: payments-table
      - id: payment-retry
        type: route
        method: POST
        path: /payments/:id/retry
        dependencies:
          - to: payments-table
      - id: payment-analytics
        type: route
        method: GET
        path: /payments/analytics
        dependencies:
          - to: payments-table
  # --- Shipping Domain ---
  - id: svc-shipping
    type: microservice
    name: shipping-service
    level: 2
    column: 3
    elements:
      - id: shipping-create
        type: route
        method: POST
        path: /shipping
        dependencies:
          - to: shipping-table
      - id: shipping-status
        type: route
        method: GET
        path: /shipping/:id
        dependencies:
          - to: shipping-table
      # Add more routes for rates, carriers, zones, etc.
      - id: shipping-rate
        type: route
        method: GET
        path: /shipping/rate
        dependencies:
          - to: shipping-table
      - id: shipping-carrier
        type: route
        method: GET
        path: /shipping/carrier
        dependencies:
          - to: shipping-table
      - id: shipping-zone
        type: route
        method: GET
        path: /shipping/zone
        dependencies:
          - to: shipping-table
      - id: shipping-label
        type: route
        method: POST
        path: /shipping/label
        dependencies:
          - to: shipping-table
      - id: shipping-analytics
        type: route
        method: GET
        path: /shipping/analytics
        dependencies:
          - to: shipping-table
  # --- Notification Domain ---
  - id: svc-notification
    type: microservice
    name: notification-service
    level: 1
    column: 1
    elements:
      - id: notify-email
        type: route
        method: POST
        path: /notify/email
        dependencies: []
      - id: notify-sms
        type: route
        method: POST
        path: /notify/sms
        dependencies: []
      # Add more routes for push, webhooks, etc.
      - id: notify-push
        type: route
        method: POST
        path: /notify/push
        dependencies: []
      - id: notify-webhook
        type: route
        method: POST
        path: /notify/webhook
        dependencies: []
      - id: notify-inapp
        type: route
        method: POST
        path: /notify/inapp
        dependencies: []
      - id: notify-analytics
        type: route
        method: GET
        path: /notify/analytics
        dependencies: []
      - id: notify-status
        type: route
        method: GET
        path: /notify/status
        dependencies: []
  # --- Catalog Domain ---
  - id: svc-catalog
    type: microservice
    name: catalog-service
    level: 2
    column: 1
    elements:
      - id: catalog-list
        type: route
        method: GET
        path: /catalog
        dependencies:
          - to: catalog-table
      - id: catalog-update
        type: route
        method: PUT
        path: /catalog/:id
        dependencies:
          - to: catalog-table
      # Add more routes for bulk, analytics, etc.
      - id: catalog-bulk
        type: route
        method: POST
        path: /catalog/bulk
        dependencies:
          - to: catalog-table
      - id: catalog-analytics
        type: route
        method: GET
        path: /catalog/analytics
        dependencies:
          - to: catalog-table
      - id: catalog-tags
        type: route
        method: GET
        path: /catalog/tags
        dependencies:
          - to: catalog-table
      - id: catalog-search
        type: route
        method: GET
        path: /catalog/search
        dependencies:
          - to: catalog-table
      - id: catalog-export
        type: route
        method: GET
        path: /catalog/export
        dependencies:
          - to: catalog-table
  # --- Review Domain ---
  - id: svc-review
    type: microservice
    name: review-service
    level: 3
    column: 1
    elements:
      - id: review-create
        type: route
        method: POST
        path: /reviews
        dependencies:
          - to: reviews-table
      - id: review-list
        type: route
        method: GET
        path: /reviews
        dependencies:
          - to: reviews-table
      # Add more routes for moderation, analytics, etc.
      - id: review-moderate
        type: route
        method: POST
        path: /reviews/moderate
        dependencies:
          - to: reviews-table
      - id: review-analytics
        type: route
        method: GET
        path: /reviews/analytics
        dependencies:
          - to: reviews-table
      - id: review-report
        type: route
        method: POST
        path: /reviews/report
        dependencies:
          - to: reviews-table
      - id: review-reply
        type: route
        method: POST
        path: /reviews/reply
        dependencies:
          - to: reviews-table
      - id: review-export
        type: route
        method: GET
        path: /reviews/export
        dependencies:
          - to: reviews-table
  # --- Search Domain ---
  - id: svc-search
    type: microservice
    name: search-service
    level: 2
    column: 4
    elements:
      - id: search-query
        type: route
        method: GET
        path: /search
        dependencies: []
      - id: search-suggest
        type: route
        method: GET
        path: /search/suggest
        dependencies: []
      - id: search-analytics
        type: route
        method: GET
        path: /search/analytics
        dependencies: []
      - id: search-index
        type: route
        method: POST
        path: /search/index
        dependencies: []
      - id: search-reindex
        type: route
        method: POST
        path: /search/reindex
        dependencies: []
  # --- Recommendation Domain ---
  - id: svc-recommendation
    type: microservice
    name: recommendation-service
    level: 2
    column: 5
    elements:
      - id: recommend-products
        type: route
        method: GET
        path: /recommend/products
        dependencies: []
      - id: recommend-users
        type: route
        method: GET
        path: /recommend/users
        dependencies: []
      - id: recommend-analytics
        type: route
        method: GET
        path: /recommend/analytics
        dependencies: []
      - id: recommend-update
        type: route
        method: POST
        path: /recommend/update
        dependencies: []
  # --- Inventory Domain ---
  - id: svc-inventory
    type: microservice
    name: inventory-service
    level: 2
    column: 6
    elements:
      - id: inventory-list
        type: route
        method: GET
        path: /inventory
        dependencies:
          - to: inventory-table
      - id: inventory-update
        type: route
        method: PUT
        path: /inventory/:id
        dependencies:
          - to: inventory-table
      - id: inventory-analytics
        type: route
        method: GET
        path: /inventory/analytics
        dependencies:
          - to: inventory-table
      - id: inventory-export
        type: route
        method: GET
        path: /inventory/export
        dependencies:
          - to: inventory-table
  # --- External APIs ---
  - id: ext-payment-gateway
    type: external
    name: payment-gateway
    level: 1
    column: 7
    elements:
      - id: ext-pay-init
        type: route
        method: POST
        path: /external/pay/init
        dependencies: []
      - id: ext-pay-status
        type: route
        method: GET
        path: /external/pay/status
        dependencies: []
  - id: ext-shipping-provider
    type: external
    name: shipping-provider
    level: 1
    column: 8
    elements:
      - id: ext-ship-init
        type: route
        method: POST
        path: /external/ship/init
        dependencies: []
      - id: ext-ship-status
        type: route
        method: GET
        path: /external/ship/status
        dependencies: []
  # --- Queues ---
  - id: queue-orders
    type: queue
    name: orders-queue
    level: 1
    column: 9
    elements:
      - id: queue-order-created
        type: event
        name: order-created
        dependencies: []
      - id: queue-order-updated
        type: event
        name: order-updated
        dependencies: []
      - id: queue-order-cancelled
        type: event
        name: order-cancelled
        dependencies: []
  - id: queue-notifications
    type: queue
    name: notifications-queue
    level: 1
    column: 10
    elements:
      - id: queue-notify-email
        type: event
        name: notify-email
        dependencies: []
      - id: queue-notify-sms
        type: event
        name: notify-sms
        dependencies: []
  # --- Caches ---
  - id: cache-products
    type: cache
    name: products-cache
    level: 1
    column: 11
    elements:
      - id: cache-products-list
        type: cache
        name: products-list
        dependencies: []
      - id: cache-products-featured
        type: cache
        name: products-featured
        dependencies: []
  # --- Databases ---
  - id: db-users
    type: mongodb
    name: users-db
    level: 6
    column: 4
    elements:
      - id: users-coll
        type: collection
        name: users
        dependencies: []
      - id: logs-coll
        type: collection
        name: logs
        dependencies: []
  - id: db-products
    type: sql
    name: products-db
    level: 4
    column: 4
    elements:
      - id: products-table
        type: table
        name: products
        dependencies: []
      - id: inventory-table
        type: table
        name: inventory
        dependencies: []
  - id: db-orders
    type: sql
    name: orders-db
    level: 5
    column: 4
    elements:
      - id: orders-table
        type: table
        name: orders
        dependencies: []
      - id: order-items-table
        type: table
        name: order_items
        dependencies: []
  - id: db-payments
    type: sql
    name: payments-db
    level: 4
    column: 4
    elements:
      - id: payments-table
        type: table
        name: payments
        dependencies: []
  - id: db-billing
    type: sql
    name: billing-db
    level: 4
    column: 4
    elements:
      - id: billing-table
        type: table
        name: billing
        dependencies: []
  - id: db-shipping
    type: sql
    name: shipping-db
    level: 4
    column: 4
    elements:
      - id: shipping-table
        type: table
        name: shipping
        dependencies: []
  - id: db-catalog
    type: sql
    name: catalog-db
    level: 4
    column: 4
    elements:
      - id: catalog-table
        type: table
        name: catalog
        dependencies: []
  - id: db-reviews
    type: sql
    name: reviews-db
    level: 4
    column: 4
    elements:
      - id: reviews-table
        type: table
        name: reviews
        dependencies: []
componentTypes:
  - microservice
  - mongodb
  - sql
  - api-gateway
  - queue
  - cache
  - mainframe
  - external
style:
  component:
    default:
      background: '#f8fafc'
      border: '#222'
      borderRadius: 16
      fontColor: '#222'
      fontSize: 14
    microservice:
      background: '#e0f7fa'
      border: '#a7b0dbff'
    sql:
      background: '#f3e5f5'
      border: '#8e24aa'
    mongodb:
      background: '#e8f5e9'
      border: '#388e3c'
    api-gateway:
      background: '#fffde7'
      border: '#fbc02d'
    queue:
      background: '#e1f5fe'
      border: '#0288d1'
    cache:
      background: '#fbe9e7'
      border: '#d84315'
    external:
      background: '#f5f5f5'
      border: '#616161'
  element:
    default:
      background: '#e0e0e0'
      fontColor: '#222'
    route:
      background: '#34d399'
      fontColor: '#fff'
    GET:
      background: '#61affe'
      fontColor: '#fff'
    POST:
      background: '#49cc90'
      fontColor: '#fff'
    PUT:
      background: '#fca130'
      fontColor: '#fff'
    DELETE:
      background: '#f93e3e'
      fontColor: '#fff'
    PATCH:
      background: '#50e3c2'
      fontColor: '#fff'
    HEAD:
      background: '#9012fe'
      fontColor: '#fff'
    OPTIONS:
      background: '#0d5aa7'
      fontColor: '#fff'
    TRACE:
      background: '#bada55'
      fontColor: '#222'
